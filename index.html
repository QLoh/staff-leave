function showSubOptions() {
  const type = document.getElementById("leaveType").value;
  const subDiv = document.getElementById("subOptions");

  // 清空舊結果
  document.getElementById("result").innerHTML = "";
  subDiv.innerHTML = "";
  subDiv.style.display = "none";

  // 特休 → 出現年資選單
  if (type === "annual") {
    subDiv.innerHTML = `
      <label>請選擇年資：
        <select id="years" onchange="calcLeave()">
          <option value="">請選擇</option>
          <option value="0.5">滿半年未滿1年</option>
          <option value="1">滿1年未滿2年</option>
          <option value="2">滿2年未滿3年</option>
          <option value="3">滿3年未滿5年</option>
          <option value="5">滿5年未滿10年</option>
          <option value="10">滿10年以上</option>
        </select>
      </label>`;
    subDiv.style.display = "block";
  }

  // 喪假 → 出現親屬選單
  else if (type === "bereavement") {
    subDiv.innerHTML = `
      <label>請選擇親屬：
        <select id="relation" onchange="calcLeave()">
          <option value="">請選擇</option>
          <option value="parent">父母、養父母、配偶（8日）</option>
          <option value="grandparent">祖父母、兄弟姊妹、子女（6日）</option>
          <option value="greatgrand">曾祖父母、外祖父母（3日）</option>
        </select>
      </label>`;
    subDiv.style.display = "block";
  }

  // 其他假別 → 直接顯示
  else if (type) {
    calcLeave();
  }
}

function calcLeave() {
  const type = document.getElementById("leaveType").value;
  let result = "";

  if (type === "annual") {
    const years = document.getElementById("years").value;
    if (!years) return; // 沒選年資就不算
    let days = 0;
    if (years == 0.5) days = 3;
    else if (years == 1) days = 7;
    else if (years == 2) days = 10;
    else if (years == 3) days = 14;
    else if (years == 5) days = 15;
    else if (years == 10) days = 30;

    result = `
      <p>假別：特休假</p>
      <p>年資：${years} 年級距</p>
      <p>天數：${days} 天</p>
      <p>是否給薪：✅ 有薪</p>
      <p>是否可扣全勤：❌ 不得因休特休影響全勤獎金</p>
      <p>部分工時：依工時計算比例（例：工時/174）</p>
    `;
  }

  if (type === "sick") {
    result = `
      <p>假別：病假</p>
      <p>一年內不超過30日（部分有薪）。</p>
      <p>是否給薪：⚠️ 住院與非住院不同，依規定計算</p>
      <p>是否可扣全勤：✅ 可扣</p>
    `;
  }

  if (type === "personal") {
    result = `
      <p>假別：事假</p>
      <p>一年內合計不得超過14日。</p>
      <p>是否給薪：❌ 無薪</p>
      <p>是否可扣全勤：✅ 可扣</p>
    `;
  }

  if (type === "marriage") {
    result = `
      <p>假別：婚假</p>
      <p>天數：8日</p>
      <p>是否給薪：✅ 有薪</p>
      <p>是否可扣全勤：❌ 不得因休婚假影響全勤獎金</p>
    `;
  }

  if (type === "bereavement") {
    const relation = document.getElementById("relation").value;
    if (!relation) return;
    let days = 0;
    if (relation === "parent") days = 8;
    if (relation === "grandparent") days = 6;
    if (relation === "greatgrand") days = 3;

    result = `
      <p>假別：喪假</p>
      <p>親屬別：${document.getElementById("relation").selectedOptions[0].text}</p>
      <p>天數：${days} 日</p>
      <p>是否給薪：✅ 有薪</p>
      <p>是否可扣全勤：❌ 不得因休喪假影響全勤獎金</p>
    `;
  }

  document.getElementById("result").innerHTML = result;
}
